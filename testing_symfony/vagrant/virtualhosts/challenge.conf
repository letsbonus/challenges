<VirtualHost *:80>

    ServerName www.challenge.local
    ServerAlias challenge.local

    ServerAdmin webmaster@localhost
    DocumentRoot /var/www_data/challenge/web

    <Directory /var/www_data/challenge/web>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted

        RewriteEngine On

        # redireccionando sin subdominio a www
        RewriteCond %{HTTP_HOST} ^challenge\.
        RewriteRule (.*) http://www.challenge.local/$1 [R=301,L]

        # Redireccionando posible barra al final sin barra
        RewriteCond %{HTTP_HOST} ^(www.)?challenge.local$ [NC]
        RewriteRule ^(.+)/$ http://www.challenge.local/$1 [R=301,L]

        # If the requested filename exists, simply serve it.
        # We only want to let Apache serve files and not directories.
        RewriteCond %{REQUEST_FILENAME} -f
        RewriteRule .? - [L]

        # Entry point
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^(.*)$ app_dev.php [QSA,L]

    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/challenge.error.log
    CustomLog ${APACHE_LOG_DIR}/challenge.access.log combined

</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
